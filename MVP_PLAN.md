# AI 学习诊断系统 - MVP 项目规划

## 📋 项目概述

**项目名称**：AI 智能学习诊断与练习生成系统

**核心价值**：
- 🎯 拍照上传试卷 → AI 自动识别题目
- 🧠 AI 自动判断正确答案 → 诊断错因
- 🚀 AI 自动生成个性化练习题
- ⚡ **无需题库和知识图谱**，快速上线

**技术特色**：
- 阿里云 OCR（教育题目专用）
- GPT-5.1（解题 + 诊断 + 生成练习）
- 纯 AI 驱动，智能化全流程

---

## ✅ 当前完成状态（Phase 0.5）

### 已实现功能

| 模块 | 状态 | 说明 |
|------|------|------|
| **OCR 识别** | ✅ 完成 | 阿里云教育 OCR，识别准确率高 |
| **GPT-5.1 解题** | ✅ 完成 | 自动判断正确答案 |
| **诊断引擎** | ✅ 完成 | 错因分析 + 掌握度评估 |
| **API 端点** | ✅ 完成 | `/ocr/parse`, `/diagnose` |
| **端到端测试** | ✅ 完成 | 图片 → OCR → 诊断全流程 |

### 技术栈（后端）

```
Python 3.13
FastAPI
阿里云 OCR API
Azure OpenAI (GPT-5.1)
Pydantic (数据验证)
```

### 现有 API

```
POST /api/v1/ocr/parse
  - 输入: 图片 URL 或 Base64
  - 输出: 题目结构化数据

POST /api/v1/diagnose
  - 输入: 题目 + 用户答案
  - 输出: 诊断结果（对错、错因、建议）
```

---

## 🚀 分阶段开发计划

---

## 【Phase 1】后端完善与稳定性增强

**目标**：让后端 API 达到"生产可用"状态，可随时被前端调用。

### 1.1 数学公式渲染优化

**问题**：OCR 识别的数学公式需要前端友好的格式

**任务**：
- [ ] OCR 结果中的数学符号统一转 LaTeX 格式
- [ ] 支持前端用 KaTeX/MathJax 渲染
- [ ] 测试常见数学符号：分数、根号、上下标、积分等

**API 改进**：
```json
{
  "question": "将 1100000000 用科学记数法表示为",
  "question_latex": "将 $1.1 \\times 10^9$ 用科学记数法表示为"
}
```

### 1.2 统一错误处理

**任务**：
- [ ] 定义统一的错误响应格式
- [ ] OCR 失败 → 友好错误提示（如"图片不清晰，请重新上传"）
- [ ] GPT 超时 → 重试机制（最多 3 次）
- [ ] 图片格式不支持 → 明确提示支持的格式

**错误响应格式**：
```json
{
  "error": true,
  "error_code": "OCR_FAILED",
  "message": "图片识别失败，请确保图片清晰且包含题目",
  "details": "...",
  "retry_available": true
}
```

### 1.3 输入验证增强

**任务**：
- [ ] 图片大小限制（< 10MB）
- [ ] 图片格式验证（JPG/PNG/WebP）
- [ ] 用户答案格式验证
- [ ] 防止恶意输入

### 1.4 性能优化

**任务**：
- [ ] 阿里云 OCR 超时优化（已设置 120s）
- [ ] GPT 调用并发控制（防止费用爆炸）
- [ ] 添加缓存机制（相同题目不重复解答）

**预期指标**：
- OCR 识别：< 10 秒
- 诊断结果：< 15 秒
- 总端到端：< 30 秒

---

## 【Phase 2】Web MVP 开发（核心优先）

**目标**：快速上线一个可用的 Web 产品，完成核心闭环。

### 2.1 技术栈选型

#### 前端
```
框架: React + Vite (快速开发)
UI 库: Ant Design / Chakra UI / Tailwind CSS
数学渲染: KaTeX
图片上传: react-dropzone
状态管理: Zustand / Context API
HTTP 客户端: axios
```

#### 部署
```
前端: Vercel (免费 + 全球 CDN)
后端: 阿里云 ECS / 本地服务器 + frp
数据库: 暂不需要（localStorage 存历史记录）
```

### 2.2 页面设计（MVP 最小版本）

#### 页面 1: 首页（上传页面）

**布局**：
```
┌──────────────────────────────────────┐
│  🎓 AI 学习诊断助手                   │
├──────────────────────────────────────┤
│                                      │
│    📸 拖拽或点击上传试卷图片          │
│    ┌────────────────────────┐       │
│    │                        │       │
│    │   支持 JPG、PNG 格式    │       │
│    │   单次最多 10MB         │       │
│    │                        │       │
│    └────────────────────────┘       │
│                                      │
│         [立即识别]                   │
│                                      │
└──────────────────────────────────────┘
```

**功能**：
- [ ] 图片拖拽上传
- [ ] 手机拍照上传
- [ ] 图片预览
- [ ] 上传进度条
- [ ] 上传后自动跳转到题目页

#### 页面 2: 题目展示与答题页

**布局**：
```
┌──────────────────────────────────────┐
│  ← 返回                               │
├──────────────────────────────────────┤
│  📝 题目内容：                         │
│  将 1.1×10⁹ 用科学记数法表示为（）     │
│                                      │
│  📋 选项：                            │
│  ○ A. 1.1 × 10⁸                      │
│  ○ B. 1.1 × 10⁸                      │
│  ○ C. 1.1 × 10⁹                      │
│  ○ D. 1.1 × 10¹⁰                     │
│                                      │
│  👤 你的答案：                         │
│  [ 请选择或输入答案 ]                  │
│                                      │
│         [提交诊断]                    │
│                                      │
└──────────────────────────────────────┘
```

**功能**：
- [ ] 渲染 OCR 识别的题目（支持 LaTeX 数学公式）
- [ ] 根据题型显示输入方式：
  - 选择题 → 单选按钮
  - 填空题 → 文本输入框
  - 解答题 → 多行文本框
- [ ] 提交后调用 `/diagnose` API
- [ ] Loading 状态（诊断中...）

#### 页面 3: 诊断结果页

**布局**：
```
┌──────────────────────────────────────┐
│  📊 诊断结果                           │
├──────────────────────────────────────┤
│  ✅ 答案正确性: ❌ 错误                 │
│  📌 正确答案: C (1.1 × 10⁹)           │
│  🎯 错误类型: 计算错误                  │
│  📈 掌握程度: 45/100                   │
│                                      │
│  📖 错因分析：                         │
│  正确的科学记数法表示应将 1100000000   │
│  写成 1.1 × 10⁹，因为...              │
│                                      │
│  💡 学习建议：                         │
│  重新练习将整数转换为科学记数法...      │
│                                      │
│  🎯 推荐练习：                         │
│  [ 查看推荐练习 ]                      │
│                                      │
│  [继续上传题目]  [查看历史记录]        │
│                                      │
└──────────────────────────────────────┘
```

**功能**：
- [ ] 展示诊断结果（对错、分数、错因）
- [ ] 数学公式正确渲染
- [ ] 可点击"查看推荐练习"按钮

#### 页面 4: 推荐练习页（GPT 生成）

**布局**：
```
┌──────────────────────────────────────┐
│  🎯 个性化练习推荐                      │
├──────────────────────────────────────┤
│  基于你的错误，我们推荐以下练习：        │
│                                      │
│  【练习 1】难度: ⭐⭐                   │
│  将 250000 用科学记数法表示为（）       │
│  A. 2.5 × 10⁴                        │
│  B. 2.5 × 10⁵                        │
│  C. 2.5 × 10⁶                        │
│  D. 2.5 × 10⁷                        │
│                                      │
│  [ 开始练习 ]  [ 查看答案 ]             │
│                                      │
│  ───────────────────────────────     │
│                                      │
│  【练习 2】...                         │
│                                      │
└──────────────────────────────────────┘
```

**功能**：
- [ ] 调用 GPT 生成 2-5 道同知识点练习题
- [ ] 展示题目 + 选项
- [ ] 可直接在页面内作答
- [ ] 查看答案和解析

### 2.3 新增后端 API

#### API 1: 生成推荐练习

```
POST /api/v1/generate-practice

请求：
{
  "knowledge_points": ["科学记数法", "整数表示"],
  "difficulty": "easy",
  "count": 3,
  "error_type": "计算错误",
  "context": "学生在指数位数判断时出错"
}

响应：
{
  "practices": [
    {
      "type": "choice",
      "question": "将 250000 用科学记数法表示为（）",
      "options": ["A. 2.5 × 10⁴", "B. 2.5 × 10⁵", ...],
      "correct_answer": "B",
      "explanation": "...",
      "difficulty": "easy",
      "knowledge_points": ["科学记数法"]
    },
    ...
  ]
}
```

**实现思路**：
- 使用 GPT-5.1 生成题目
- Prompt 工程：基于错因生成针对性练习
- 返回结构化 JSON

#### API 2: 批量诊断（可选）

```
POST /api/v1/diagnose-batch

请求：
{
  "problems": [
    {"problem": {...}, "user_answer": "A"},
    {"problem": {...}, "user_answer": "C"},
    ...
  ]
}

响应：
{
  "results": [
    {"correct": true, ...},
    {"correct": false, ...},
    ...
  ]
}
```

---

## 【Phase 3】AI 驱动的推荐策略

**目标**：无题库情况下，实现智能推荐。

### 3.1 知识点自动提取（GPT）

**任务**：
- [ ] 从题目中自动提取知识点
- [ ] 知识点标准化（如"科学计数法" vs "科学记数法"）
- [ ] 建立知识点层级关系（可选）

**示例**：
```
题目: "将 1100000000 用科学记数法表示为"
↓
知识点: ["科学记数法", "指数运算", "整数表示"]
```

### 3.2 练习生成策略

**策略 1：同难度、同知识点**
- 生成与错题相同难度的题目
- 知识点相同，数字/场景不同

**策略 2：降低难度（如果掌握度 < 40）**
- 自动降低一个难度级别
- 提供更详细的解题步骤

**策略 3：知识点关联**
- 如果错在"科学记数法"，推荐"指数运算"基础题

### 3.3 学习路径规划（GPT 生成）

**任务**：
- [ ] 根据多次诊断结果，生成学习计划
- [ ] 弱项总结
- [ ] 建议学习顺序

**示例输出**：
```
📈 你的学习报告：

弱项知识点：
1. 科学记数法（掌握度 45/100）
2. 指数运算（掌握度 60/100）

建议学习路径：
第 1 天：复习科学记数法基础概念
第 2-3 天：练习整数与科学记数法转换（10 题）
第 4 天：练习小数与科学记数法转换（10 题）
第 5 天：综合练习
```

---

## 【Phase 4】体验优化与迭代

### 4.1 UI/UX 优化

**任务**：
- [ ] AI 老师形象（吉祥物/头像）
- [ ] Loading 动画优化
- [ ] 答题卡片动画
- [ ] 暗黑模式支持

### 4.2 历史记录

**任务**：
- [ ] localStorage 存储答题历史
- [ ] 展示历史题目列表
- [ ] 查看过往诊断结果
- [ ] 导出学习报告（PDF）

### 4.3 数据可视化

**任务**：
- [ ] 知识点掌握度雷达图
- [ ] 答题正确率曲线
- [ ] 学习时长统计

### 4.4 多模型验证（可选）

**任务**：
- [ ] 解题时同时调用 GPT-5.1 和 GPT-4o
- [ ] 如果结果不一致，提示"需要人工复核"

---

## 🎯 核心闭环总结

```
用户上传图片
    ↓
阿里云 OCR 识别题目
    ↓
GPT-5.1 自动解题（判断正确答案）
    ↓
用户输入答案
    ↓
GPT-5.1 诊断错因（错误类型 + 分析）
    ↓
GPT-5.1 生成个性化练习题（无需题库）
    ↓
用户继续练习
    ↓
循环优化，形成学习闭环
```

---

## 📅 时间规划（建议）

| 阶段 | 内容 | 预计时间 | 优先级 |
|------|------|---------|--------|
| **Phase 1** | 后端完善 | 3-5 天 | 🔥 高 |
| **Phase 2.1** | 前端框架搭建 | 2 天 | 🔥 高 |
| **Phase 2.2** | 核心页面开发 | 5-7 天 | 🔥 高 |
| **Phase 2.3** | 练习生成 API | 2-3 天 | 🔥 高 |
| **Phase 3** | 推荐策略优化 | 3-5 天 | ⚠️ 中 |
| **Phase 4** | 体验优化 | 持续迭代 | ⚠️ 中 |

**MVP 上线目标**：2-3 周

---

## 💰 成本估算

### API 调用成本

**阿里云 OCR**：
- 教育题目识别：¥0.01/张
- 每天 100 用户 × 5 题 = 500 次调用
- 月成本：500 × 30 × ¥0.01 = ¥150

**Azure OpenAI (GPT-5.1)**：
- 解题 + 诊断 + 生成练习：约 3000 tokens/题
- GPT-5.1 价格：~$0.01/1K tokens
- 每题成本：$0.03（约 ¥0.21）
- 月成本（500 题/天）：¥3,150

**总计**：约 ¥3,300/月（100 DAU）

### 服务器成本

- 阿里云 ECS（2核4G）：¥100-200/月
- Vercel 前端托管：免费
- 总计：¥100-200/月

**合计**：约 ¥3,500/月（初期）

---

## ⚠️ 风险与挑战

### 技术风险

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| OCR 识别错误 | 题目错误 → 诊断错误 | 用户可手动修正 OCR 结果 |
| GPT 解题错误 | 错误答案 → 误诊 | 多模型验证（GPT-4o + GPT-5.1） |
| GPT 超时 | 用户体验差 | 重试机制 + 超时提示 |
| 成本超预算 | 无法持续运营 | 限制免费用户调用次数 |

### 产品风险

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| 用户不信任 AI | 使用率低 | 展示"AI 准确率 95%"等数据 |
| 题型覆盖不全 | 部分题目无法识别 | 逐步优化 OCR + GPT prompt |
| 竞品压力 | 市场份额被抢占 | 快速迭代，保持技术领先 |

---

## 🚀 下一步行动（立即开始）

### 本周任务（Phase 1）

1. **后端 API 完善**
   - [ ] 添加 `/generate-practice` API
   - [ ] 优化错误处理
   - [ ] 添加输入验证

2. **前端框架搭建**
   - [ ] 创建 React + Vite 项目
   - [ ] 配置 Tailwind CSS / Ant Design
   - [ ] 配置 axios + API 调用

3. **核心页面开发**
   - [ ] 上传页面
   - [ ] 题目展示页面

### 下周任务（Phase 2）

4. **完成核心闭环**
   - [ ] 诊断结果页
   - [ ] 推荐练习页
   - [ ] 端到端测试

5. **部署上线**
   - [ ] Vercel 部署前端
   - [ ] 后端部署到服务器
   - [ ] 域名绑定

---

## 📚 参考资料

### 技术文档
- [阿里云 OCR API](https://help.aliyun.com/document_detail/442273.html)
- [Azure OpenAI API](https://learn.microsoft.com/en-us/azure/ai-services/openai/)
- [KaTeX 数学渲染](https://katex.org/)
- [React Dropzone](https://react-dropzone.js.org/)

### 竞品分析
- 小猿搜题（题库驱动）
- 作业帮（人工 + AI）
- Khan Academy（知识图谱）

**我们的差异化**：纯 AI 驱动，无需题库，快速上线！

---

## ✅ 项目成功指标

### MVP 阶段（3 周内）

- [ ] 可识别至少 3 种题型（选择、填空、计算）
- [ ] OCR 准确率 > 90%
- [ ] 诊断准确率 > 85%
- [ ] 端到端响应时间 < 30 秒
- [ ] 前端可正常运行并完成完整流程

### 产品验证阶段（3 个月内）

- [ ] 100+ 真实用户测试
- [ ] 用户满意度 > 80%
- [ ] 日活用户 > 50
- [ ] 每用户平均使用 > 5 道题

---

**备注**：本规划聚焦 MVP 快速上线，后续可根据用户反馈调整优先级。

---

*最后更新: 2025-11-23*
*维护者: AI 学习诊断系统团队*

